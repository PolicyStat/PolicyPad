<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 * WYMeditor : what you see is What You Mean web-based editor
 * Copyright (c) 2005 - 2009 Jean-Francois Hovinne, http://www.wymeditor.org/
 * Dual licensed under the MIT (MIT-license.txt)
 * and GPL (GPL-license.txt) licenses.
 *
 * For further information visit:
 *        http://www.wymeditor.org/
 *
 * File Name:
 *        01-basic.html
 *        WYMeditor integration example.
 *        See the documentation for more info.
 *
 * File Authors:
 *        Jean-Francois Hovinne - http://www.hovinne.com/
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WYMeditor</title>
<!-- jQuery library is required, see http://jquery.com/ -->
<script type="text/javascript" src="wymeditor/jquery/jquery.js"></script>
<!-- WYMeditor main JS file, minified version -->
<script type="text/javascript" src="wymeditor/wymeditor/jquery.wymeditor.js"></script>
<script type="text/javascript" src="../wymplugin.js"></script>
<script type="text/javascript" src="../policypad.js"></script>

<script type="text/javascript">

/* Here we replace each element with class 'wymeditor'
 * (typically textareas) by a WYMeditor instance.
 * 
 * We could use the 'html' option, to initialize the editor's content.
 * If this option isn't set, the content is retrieved from
 * the element being replaced.
 */

var initialHtml = '<p><b>Heading</b></p><p>Hello world!</p>';

function wymeditor_onchange(evt) {
  var counter = $('#counter');

  var i = parseInt(counter.text());
  i += 1;
  counter.text(i);

  var autoupdate = $('#autoupdate').attr('checked');
  if (autoupdate) {
    update();
  }

}

jQuery(function() {
    jQuery('.wymeditor').wymeditor({
            html: initialHtml,
            postInit: function(wym) {
                    //activate wymplugin
                    wym.wymplugin(wymeditor_onchange);
            }
    });
});

//debugging
var wym = jQuery.wymeditors(0);

function update() {
    var wym = jQuery.wymeditors(0);
    var docPrev = $('#docPrev');
    var docCur = $('#docCur');
    var changes = $('#changes');

    var newhtml = wym.html();
    var oldhtml = docCur.text();

    msg = generateChangeset(oldhtml, newhtml);

    $('<div></div>').text(msg).prependTo(changes)
    //changes.prepend(msg + "<br />");

    docCur.text(newhtml);
    docPrev.text(oldhtml);
}

function initialize() {
    $('#txtDoc').val(initialHtml);
    $('#docCur').text(initialHtml);
}

function btnRefresh_onclick() {
        update();
}



</script>


</head>

<body onload="initialize();">
<h1>WYMeditor integration test</h1>
<p>Test retriving html for diffs, displaying changesets, detecting changes, and edits highlighting</p>
<form method="post" action="">
<textarea class="wymeditor">&lt;p&gt;Hello, World!&lt;/p&gt;</textarea>
<!--input type="submit" class="wymupdate" /-->
</form>

<form>
  <div>Document updates: <span id="counter">0</span>
  <br />
  <div>
  <div style="width: 47%; margin-right: 50px; display:inline-block; float: left;">
    Previous HTML: <div id="docPrev">No prior revision</div>
  </div>
  <div style="display:inline-block; width: 47%; float:right;">
    Current HTML: <div id="docCur"></div>
  </div>
  </div>
  <br />

  <div style="clear:both;"></div>
  <div style="margin-top: 25px; clear:both;">
    Changes: <div id="changes"></div>
  </div>
  <br />
  
  <!--Changes:<textarea id="txtLog" rows="10" cols="80"></textarea> <br />-->
  <input type="button" name="btnRefresh" value="Refresh" onclick="btnRefresh_onclick();" /><input type="checkbox" id="autoupdate">Auto-update</input>
</form>

</body>
</html>
